.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_auto_examples_dynamics_225_HW09_P2v2.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_dynamics_225_HW09_P2v2.py:


Modal analysis - 1r
===================


.. code-block:: default


    import ema as em
    import matplotlib.pyplot as plt
    import numpy as np
    # %config InlineBackend.figure_format = 'svg'

    mdl = em.rModel(2,3)
    n = mdl.dnodes
    e = mdl.delems
    w = 24
    h = 12

    mdl.frame((1,w), (3,h))

    for node in n.values():
        mdl.fix(node, 'rz')
    
    n['4'].mass = 1
    n['6'].mass = 1
    n['8'].mass = 0.5
    mdl.fix(n['1'], ['x', 'y'])
    mdl.fix(n['2'], ['x', 'y'])

    mdl.DOF = [[10, 11, 12], [13, 14, 15], 
               [ 1, 11,  4], [ 1, 14,  5], 
               [ 2, 11,  6], [ 2, 14,  7], 
               [ 3, 11,  8], [ 3, 14,  9]]





.. code-block:: pytb

    Traceback (most recent call last):
      File "C:\Users\claud\Anaconda3\lib\site-packages\sphinx_gallery\gen_rst.py", line 440, in _memory_usage
        out = func()
      File "C:\Users\claud\Anaconda3\lib\site-packages\sphinx_gallery\gen_rst.py", line 425, in __call__
        exec(self.code, self.globals)
      File "C:\Users\claud\OneDrive\400_box\Python\myPackages\ema\ema\examples\dynamics\225_HW09_P2v2.py", line 12, in <module>
        # %config InlineBackend.figure_format = 'svg'
    AttributeError: module 'ema' has no attribute 'rModel'




Part a)
-------



.. code-block:: default


    K = em.K_matrix(mdl)
    M = em.Mass_matrix(mdl)
    K.f*h**3

    M.f



Part b)
-------



.. code-block:: default


    shapes = em.analysis.ModalAnalysis(mdl)

    shapes

    U = em.U_vector(em.A_matrix(mdl))

    colors = ['b', 'y','pink']
    fig, ax = plt.subplots(1,3)
    for i, shape in enumerate(shapes[1].T):
        U[0:3] = shape
        em.plot_modes(mdl, U, ax[i], color=colors[i], label=str(i+1))
    plt.legend();



Part c) Verify orthogonality
----------------------------



.. code-block:: default


    phis = np.around(shapes[1], 7)
    phis

    print(phis[:,0] @ M.f @ phis[:,1])

    print(phis[:,0] @ M.f @ phis[:,2])

    print(phis[:,1] @ M.f @ phis[:,2])



Part d) Normalize modes.
------------------------


Each mode shape is normalized so that when multiplied by the problem
variable, :math:`\frac{1}{\sqrt{m}}`, they will generate a modal mass
matrix, :math:`M_n`, equal to the identity matrix.



.. code-block:: default


    phi_n = np.zeros((3,3))
    phi_n[:,0] = phis[:,0]/((phis[:,0] @ M.f @ phis[:,0]))**(1/2)
    print(phi_n[:,0])
    phi_n[:,0].T @ M.f @ phi_n[:,0]

    phi_n[:,1] = phis[:,1]/((phis[:,1] @ M.f @ phis[:,1]))**(1/2)
    print(phi_n[:,1])
    phi_n[:,1].T @ M.f @ phi_n[:,1]

    phi_n[:,2] = phis[:,2]/((phis[:,2] @ M.f @ phis[:,2]))**(1/2)
    print(phi_n[:,2])
    phi_n[:,2].T @ M.f @ phi_n[:,2]

    Id = np.around(phi_n.T @ M.f @ phi_n,7)
    Id

.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.010 seconds)


.. _sphx_glr_download_auto_examples_dynamics_225_HW09_P2v2.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: 225_HW09_P2v2.py <225_HW09_P2v2.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: 225_HW09_P2v2.ipynb <225_HW09_P2v2.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
